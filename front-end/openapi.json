{
  "openapi": "3.0.3",
  "info": {
    "title": "LittyPicky API",
    "description": "A gamified litter-picking community app with geospatial features",
    "contact": {
      "name": "LittyPicky Team",
      "email": "team@littypicky.com"
    },
    "license": {
      "name": "MIT"
    },
    "version": "0.1.0"
  },
  "paths": {
    "/api/admin/reports": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Get all reports (not just nearby)",
        "description": "GET /api/admin/reports",
        "operationId": "list_all_reports",
        "responses": {
          "200": {
            "description": "Returns all reports",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AdminReportView"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin access required"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/admin/reports/{id}": {
      "delete": {
        "tags": [
          "Admin"
        ],
        "summary": "Delete a report (for spam/inappropriate content)",
        "description": "DELETE /api/admin/reports/:id",
        "operationId": "delete_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Report deleted"
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/admin/users": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Get all users (paginated)",
        "description": "GET /api/admin/users?page=1&limit=20",
        "operationId": "list_users",
        "responses": {
          "200": {
            "description": "Returns list of users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserResponse"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Admin access required"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/admin/users/{id}": {
      "get": {
        "tags": [
          "Admin"
        ],
        "summary": "Get user by ID",
        "description": "GET /api/admin/users/:id",
        "operationId": "get_user_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Returns user details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/admin/users/{id}/ban": {
      "put": {
        "tags": [
          "Admin"
        ],
        "operationId": "toggle_user_ban",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BanUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User ban status updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "403": {
            "description": "Admin access required"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/auth/forgot-password": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "forgot_password",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ForgotPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Password reset email sent (if email exists)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/google": {
      "get": {
        "tags": [
          "OAuth"
        ],
        "summary": "Initiate Google OAuth login",
        "description": "GET /api/auth/google",
        "operationId": "google_login",
        "responses": {
          "200": {
            "description": "Returns Google OAuth authorization URL",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthLoginResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/google/callback": {
      "get": {
        "tags": [
          "OAuth"
        ],
        "summary": "Handle Google OAuth callback",
        "description": "GET /api/auth/google/callback",
        "operationId": "google_callback",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OAuth login successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokens"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired session"
          },
          "500": {
            "description": "OAuth exchange failed"
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Login successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokens"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials"
          },
          "403": {
            "description": "Email not verified"
          }
        }
      }
    },
    "/api/auth/logout": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "logout",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefreshTokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Logged out successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/refresh": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "refresh_token",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefreshTokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Token refreshed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshTokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token"
          }
        }
      }
    },
    "/api/auth/register": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "register",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "User registered successfully. Verification email sent.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "409": {
            "description": "Email already registered"
          }
        }
      }
    },
    "/api/auth/resend-verification": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "resend_verification",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResendVerificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Verification email sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Email already verified"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/api/auth/reset-password": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "reset_password",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Password reset successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired token"
          }
        }
      }
    },
    "/api/auth/verify-email": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "operationId": "verify_email",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyEmailRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Email verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokens"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired token"
          }
        }
      }
    },
    "/api/images/reports/{id}/after": {
      "get": {
        "tags": [
          "Images"
        ],
        "summary": "Get report after photo",
        "description": "GET /api/images/reports/:id/after",
        "operationId": "get_report_after_photo",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Returns image"
          },
          "404": {
            "description": "Report or image not found"
          }
        }
      }
    },
    "/api/images/reports/{id}/before": {
      "get": {
        "tags": [
          "Images"
        ],
        "summary": "Get report before photo",
        "description": "GET /api/images/reports/:id/before",
        "operationId": "get_report_before_photo",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Returns image"
          },
          "404": {
            "description": "Report or image not found"
          }
        }
      }
    },
    "/api/leaderboards": {
      "get": {
        "tags": [
          "Leaderboards"
        ],
        "summary": "Get global leaderboard",
        "description": "GET /api/leaderboards?period=weekly",
        "operationId": "get_global_leaderboard",
        "parameters": [
          {
            "name": "period",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            },
            "example": "weekly"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns leaderboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LeaderboardEntry"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/leaderboards/city/{city}": {
      "get": {
        "tags": [
          "Leaderboards"
        ],
        "summary": "Get leaderboard by city",
        "description": "GET /api/leaderboards/city/:city?period=weekly",
        "operationId": "get_city_leaderboard",
        "parameters": [
          {
            "name": "city",
            "in": "path",
            "description": "City name",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            },
            "example": "weekly"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns city leaderboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LeaderboardEntry"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/leaderboards/country/{country}": {
      "get": {
        "tags": [
          "Leaderboards"
        ],
        "summary": "Get leaderboard by country",
        "description": "GET /api/leaderboards/country/:country?period=weekly",
        "operationId": "get_country_leaderboard",
        "parameters": [
          {
            "name": "country",
            "in": "path",
            "description": "Country name",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "period",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            },
            "example": "weekly"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns country leaderboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LeaderboardEntry"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/reports": {
      "post": {
        "tags": [
          "Reports"
        ],
        "summary": "Create a new litter report",
        "description": "POST /api/reports",
        "operationId": "create_report",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Report created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input or image"
          },
          "403": {
            "description": "Email verification required"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/my-clears": {
      "get": {
        "tags": [
          "Reports"
        ],
        "summary": "Get all reports cleared by the current user",
        "description": "GET /api/reports/my-clears",
        "operationId": "get_my_cleared_reports",
        "responses": {
          "200": {
            "description": "Returns user's cleared reports",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReportResponse"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/my-reports": {
      "get": {
        "tags": [
          "Reports"
        ],
        "summary": "Get all reports created by the current user",
        "description": "GET /api/reports/my-reports",
        "operationId": "get_my_reports",
        "responses": {
          "200": {
            "description": "Returns user's reports",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReportResponse"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/nearby": {
      "get": {
        "tags": [
          "Reports"
        ],
        "summary": "Get nearby reports",
        "description": "GET /`api/reports/nearby?latitude=X&longitude=Y&radius_km=Z`",
        "operationId": "get_nearby_reports",
        "parameters": [
          {
            "name": "latitude",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "double"
            },
            "example": 51.5074
          },
          {
            "name": "longitude",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "double"
            },
            "example": -0.1278
          },
          {
            "name": "radius_km",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true,
              "maximum": 100,
              "minimum": 0.1
            },
            "example": 5.0
          }
        ],
        "responses": {
          "200": {
            "description": "Returns reports within radius",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReportResponse"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid coordinates"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/{id}": {
      "get": {
        "tags": [
          "Reports"
        ],
        "summary": "Get a single report by ID",
        "description": "GET /api/reports/:id",
        "operationId": "get_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Returns report details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportResponse"
                }
              }
            }
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/{id}/claim": {
      "post": {
        "tags": [
          "Reports"
        ],
        "summary": "Claim a report for cleanup",
        "description": "POST /api/reports/:id/claim",
        "operationId": "claim_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Report claimed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Report already claimed or not in pending status"
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/{id}/clear": {
      "post": {
        "tags": [
          "Reports"
        ],
        "summary": "Clear a report with after photo",
        "description": "POST /api/reports/:id/clear",
        "operationId": "clear_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ClearReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Report cleared successfully. Points awarded.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Report not claimed by you or invalid status"
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/{id}/verifications": {
      "get": {
        "tags": [
          "Verifications"
        ],
        "summary": "Get all verifications for a report",
        "description": "GET /api/reports/:id/verifications",
        "operationId": "get_report_verifications",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Returns list of verifications",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/VerificationResponse"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/reports/{id}/verify": {
      "post": {
        "tags": [
          "Verifications"
        ],
        "summary": "Verify a cleared report",
        "description": "POST /api/reports/:id/verify",
        "operationId": "verify_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateVerificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Report verification submitted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerificationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid report status or self-verification"
          },
          "403": {
            "description": "Not enough experience to verify"
          },
          "404": {
            "description": "Report not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/test/cleanup": {
      "delete": {
        "tags": [
          "test-helpers"
        ],
        "summary": "Clean up all test data for a specific user",
        "description": "Deletes the user and all associated data (reports, verifications, etc.)\n\n**WARNING: This endpoint should ONLY be enabled in test/development environments**",
        "operationId": "cleanup_test_data",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CleanupRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Test data cleaned up successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestHelperResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/test/status": {
      "get": {
        "tags": [
          "test-helpers"
        ],
        "summary": "Get the current test environment status",
        "operationId": "test_status",
        "responses": {
          "200": {
            "description": "Test helpers are enabled"
          }
        }
      }
    },
    "/api/test/verify-email/{email}": {
      "post": {
        "tags": [
          "test-helpers"
        ],
        "summary": "Verify an email address for testing purposes",
        "description": "This bypasses the normal email verification flow\n\n**WARNING: This endpoint should ONLY be enabled in test/development environments**",
        "operationId": "verify_email_for_testing",
        "parameters": [
          {
            "name": "email",
            "in": "path",
            "description": "Email address to verify",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Email verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestHelperResponse"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/users/me": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Get current authenticated user's profile",
        "description": "GET /api/users/me",
        "operationId": "get_current_user",
        "responses": {
          "200": {
            "description": "Returns user profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "Users"
        ],
        "summary": "Update current user's profile",
        "description": "PATCH /api/users/me",
        "operationId": "update_current_user",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Profile updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/api/users/me/score": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Get user's score and statistics",
        "description": "GET /api/users/me/score",
        "operationId": "get_current_user_score",
        "responses": {
          "200": {
            "description": "Returns user statistics and score",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserScoreRecord"
                }
              }
            }
          },
          "404": {
            "description": "Score not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "AdminReportView": {
        "type": "object",
        "required": [
          "id",
          "reporter_id",
          "latitude",
          "longitude",
          "status",
          "created_at",
          "reporter_name",
          "reporter_email"
        ],
        "properties": {
          "claimed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "claimed_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "cleared_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "cleared_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          },
          "reporter_email": {
            "type": "string"
          },
          "reporter_id": {
            "type": "string",
            "format": "uuid"
          },
          "reporter_name": {
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/ReportStatus"
          }
        }
      },
      "AuthTokens": {
        "type": "object",
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "properties": {
          "access_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "refresh_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "user": {
            "$ref": "#/components/schemas/UserResponse"
          }
        }
      },
      "BanUserRequest": {
        "type": "object",
        "description": "Ban/unban a user\nPUT /api/admin/users/:id/ban",
        "required": [
          "is_active"
        ],
        "properties": {
          "is_active": {
            "type": "boolean",
            "example": false
          }
        }
      },
      "CleanupRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string"
          }
        }
      },
      "ClearReportRequest": {
        "type": "object",
        "required": [
          "photo_base64"
        ],
        "properties": {
          "photo_base64": {
            "type": "string",
            "example": "data:image/jpeg;base64,..."
          }
        }
      },
      "CreateReportRequest": {
        "type": "object",
        "required": [
          "latitude",
          "longitude",
          "photo_base64"
        ],
        "properties": {
          "description": {
            "type": "string",
            "example": "Plastic bottles near the park entrance",
            "nullable": true
          },
          "latitude": {
            "type": "number",
            "format": "double",
            "example": 51.5074
          },
          "longitude": {
            "type": "number",
            "format": "double",
            "example": -0.1278
          },
          "photo_base64": {
            "type": "string",
            "example": "data:image/jpeg;base64,..."
          }
        }
      },
      "CreateVerificationRequest": {
        "type": "object",
        "required": [
          "is_verified"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "example": "Good job!",
            "nullable": true
          },
          "is_verified": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "ForgotPasswordRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "example": "user@example.com"
          }
        }
      },
      "LeaderboardEntry": {
        "type": "object",
        "required": [
          "user_id",
          "full_name",
          "city",
          "country",
          "total_points",
          "reports_cleared",
          "current_streak",
          "rank"
        ],
        "properties": {
          "city": {
            "type": "string"
          },
          "country": {
            "type": "string"
          },
          "current_streak": {
            "type": "integer",
            "format": "int32"
          },
          "full_name": {
            "type": "string"
          },
          "rank": {
            "type": "integer",
            "format": "int64"
          },
          "reports_cleared": {
            "type": "integer",
            "format": "int32"
          },
          "total_points": {
            "type": "integer",
            "format": "int32"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ListUsersQuery": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int64",
            "example": 20,
            "nullable": true
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "example": 1,
            "nullable": true
          }
        }
      },
      "LitterReport": {
        "type": "object",
        "required": [
          "id",
          "reporter_id",
          "latitude",
          "longitude",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "address": {
            "type": "string",
            "nullable": true
          },
          "claimed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "claimed_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "cleared_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "cleared_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          },
          "photo_after": {
            "type": "string",
            "nullable": true
          },
          "photo_before": {
            "type": "string",
            "nullable": true
          },
          "reporter_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "$ref": "#/components/schemas/ReportStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "example": "user@example.com"
          },
          "password": {
            "type": "string",
            "example": "SecurePassword123"
          }
        }
      },
      "MessageResponse": {
        "type": "object",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "example": "Operation successful"
          }
        }
      },
      "OAuthLoginResponse": {
        "type": "object",
        "description": "Response for OAuth login",
        "required": [
          "auth_url"
        ],
        "properties": {
          "auth_url": {
            "type": "string",
            "example": "https://accounts.google.com/o/oauth2/v2/auth?..."
          }
        }
      },
      "RefreshTokenRequest": {
        "type": "object",
        "required": [
          "refresh_token"
        ],
        "properties": {
          "refresh_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        }
      },
      "RefreshTokenResponse": {
        "type": "object",
        "required": [
          "access_token"
        ],
        "properties": {
          "access_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "required": [
          "email",
          "password",
          "full_name",
          "city",
          "country"
        ],
        "properties": {
          "city": {
            "type": "string",
            "example": "London"
          },
          "country": {
            "type": "string",
            "example": "UK"
          },
          "email": {
            "type": "string",
            "example": "user@example.com"
          },
          "full_name": {
            "type": "string",
            "example": "John Doe"
          },
          "password": {
            "type": "string",
            "example": "SecurePassword123",
            "minLength": 8
          }
        }
      },
      "ReportResponse": {
        "type": "object",
        "required": [
          "id",
          "reporter_id",
          "latitude",
          "longitude",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "address": {
            "type": "string",
            "nullable": true
          },
          "claimed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "claimed_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "cleared_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "cleared_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "latitude": {
            "type": "number",
            "format": "double"
          },
          "longitude": {
            "type": "number",
            "format": "double"
          },
          "photo_after": {
            "type": "string",
            "nullable": true
          },
          "photo_before": {
            "type": "string",
            "nullable": true
          },
          "reporter_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "$ref": "#/components/schemas/ReportStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ReportStatus": {
        "type": "string",
        "enum": [
          "pending",
          "claimed",
          "cleared",
          "verified"
        ]
      },
      "ReportVerification": {
        "type": "object",
        "required": [
          "id",
          "report_id",
          "verifier_id",
          "is_verified",
          "created_at"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_verified": {
            "type": "boolean"
          },
          "report_id": {
            "type": "string",
            "format": "uuid"
          },
          "verifier_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ResendVerificationRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "example": "user@example.com"
          }
        }
      },
      "ResetPasswordRequest": {
        "type": "object",
        "required": [
          "token",
          "new_password"
        ],
        "properties": {
          "new_password": {
            "type": "string",
            "example": "NewSecurePassword123",
            "minLength": 8
          },
          "token": {
            "type": "string",
            "example": "VGhpc0lzQVRva2Vu..."
          }
        }
      },
      "ScoreResponse": {
        "type": "object",
        "required": [
          "user_id",
          "total_points",
          "reports_cleared",
          "current_streak",
          "longest_streak"
        ],
        "properties": {
          "current_streak": {
            "type": "integer",
            "format": "int32"
          },
          "longest_streak": {
            "type": "integer",
            "format": "int32"
          },
          "reports_cleared": {
            "type": "integer",
            "format": "int32"
          },
          "total_points": {
            "type": "integer",
            "format": "int32"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TestHelperResponse": {
        "type": "object",
        "required": [
          "success",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "UpdateUserRequest": {
        "type": "object",
        "properties": {
          "city": {
            "type": "string",
            "example": "Manchester",
            "nullable": true
          },
          "country": {
            "type": "string",
            "example": "UK",
            "nullable": true
          },
          "full_name": {
            "type": "string",
            "example": "Jane Doe",
            "nullable": true
          },
          "search_radius_km": {
            "type": "integer",
            "format": "int32",
            "example": 10,
            "nullable": true,
            "maximum": 100,
            "minimum": 1
          }
        }
      },
      "User": {
        "type": "object",
        "required": [
          "id",
          "email",
          "full_name",
          "city",
          "country",
          "search_radius_km",
          "role",
          "is_active",
          "email_verified",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "city": {
            "type": "string"
          },
          "country": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "email": {
            "type": "string"
          },
          "email_verified": {
            "type": "boolean"
          },
          "email_verified_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "full_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_active": {
            "type": "boolean"
          },
          "oauth_provider": {
            "type": "string",
            "nullable": true
          },
          "oauth_subject": {
            "type": "string",
            "nullable": true
          },
          "role": {
            "$ref": "#/components/schemas/UserRole"
          },
          "search_radius_km": {
            "type": "integer",
            "format": "int32"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "UserResponse": {
        "type": "object",
        "required": [
          "id",
          "email",
          "full_name",
          "city",
          "country",
          "search_radius_km",
          "role",
          "email_verified",
          "created_at"
        ],
        "properties": {
          "city": {
            "type": "string"
          },
          "country": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "email": {
            "type": "string"
          },
          "email_verified": {
            "type": "boolean"
          },
          "full_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "role": {
            "$ref": "#/components/schemas/UserRole"
          },
          "search_radius_km": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "UserRole": {
        "type": "string",
        "enum": [
          "user",
          "admin"
        ]
      },
      "UserScore": {
        "type": "object",
        "required": [
          "id",
          "user_id",
          "total_points",
          "reports_cleared",
          "current_streak",
          "longest_streak",
          "total_reports",
          "total_clears",
          "total_verifications",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "current_streak": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_cleared_date": {
            "type": "string",
            "format": "date",
            "nullable": true
          },
          "longest_streak": {
            "type": "integer",
            "format": "int32"
          },
          "reports_cleared": {
            "type": "integer",
            "format": "int32"
          },
          "total_clears": {
            "type": "integer",
            "format": "int32"
          },
          "total_points": {
            "type": "integer",
            "format": "int32"
          },
          "total_reports": {
            "type": "integer",
            "format": "int32"
          },
          "total_verifications": {
            "type": "integer",
            "format": "int32"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "UserScoreRecord": {
        "type": "object",
        "required": [
          "total_points",
          "total_reports",
          "total_clears",
          "total_verifications",
          "current_streak",
          "longest_streak"
        ],
        "properties": {
          "current_streak": {
            "type": "integer",
            "format": "int32"
          },
          "last_clear_date": {
            "type": "string",
            "format": "date",
            "nullable": true
          },
          "longest_streak": {
            "type": "integer",
            "format": "int32"
          },
          "total_clears": {
            "type": "integer",
            "format": "int32"
          },
          "total_points": {
            "type": "integer",
            "format": "int32"
          },
          "total_reports": {
            "type": "integer",
            "format": "int32"
          },
          "total_verifications": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "VerificationResponse": {
        "type": "object",
        "required": [
          "id",
          "report_id",
          "verifier_id",
          "is_verified",
          "created_at"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_verified": {
            "type": "boolean"
          },
          "report_id": {
            "type": "string",
            "format": "uuid"
          },
          "verifier_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "VerifyEmailRequest": {
        "type": "object",
        "required": [
          "token"
        ],
        "properties": {
          "token": {
            "type": "string",
            "example": "VGhpc0lzQVRva2Vu..."
          }
        }
      }
    },
    "securitySchemes": {
      "bearer_auth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "User authentication and registration"
    },
    {
      "name": "OAuth",
      "description": "OAuth authentication with Google"
    },
    {
      "name": "Users",
      "description": "User profile management"
    },
    {
      "name": "Reports",
      "description": "Litter report management"
    },
    {
      "name": "Images",
      "description": "Image serving endpoints"
    },
    {
      "name": "Verifications",
      "description": "Report verification"
    },
    {
      "name": "Leaderboards",
      "description": "User rankings and leaderboards"
    },
    {
      "name": "Admin",
      "description": "Administrative endpoints (admin role required)"
    },
    {
      "name": "test-helpers",
      "description": "Test helper endpoints (TESTING ONLY - DO NOT USE IN PRODUCTION)"
    }
  ]
}
